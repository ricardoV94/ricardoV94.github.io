<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Introduction #  In this article I will derive the gamma distribution in a most unprincipled way.
Why? First, there are many good resources out there explaining how to derive the gamma distribution from first principles, usually involving these idealized things called poisson processes. These are great sources and I would definitely recommend them. This one by Aerin Kim is amazing.
However, more often than not, people use gamma distributions in real world problems for much more mundane reasons: It&rsquo;s a well behaved yet flexible positive continuous distribution."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="A most unprincipled derivation of the gamma distribution"><meta property="og:description" content="Introduction #  In this article I will derive the gamma distribution in a most unprincipled way.
Why? First, there are many good resources out there explaining how to derive the gamma distribution from first principles, usually involving these idealized things called poisson processes. These are great sources and I would definitely recommend them. This one by Aerin Kim is amazing.
However, more often than not, people use gamma distributions in real world problems for much more mundane reasons: It&rsquo;s a well behaved yet flexible positive continuous distribution."><meta property="og:type" content="article"><meta property="og:url" content="https://ricardov94.github.io/posts/gamma_distribution/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-13T00:00:00+00:00"><meta property="article:modified_time" content="2021-07-13T00:00:00+00:00"><title>A most unprincipled derivation of the gamma distribution | As long as everything adds up to one</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.336536302c9333426b2435f844b8628561bae88f21fec7883f90118e27d33980.css integrity="sha256-M2U2MCyTM0JrJDX4RLhihWG66I8h/seIP5ARjifTOYA=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script><script defer src=/en.search.min.dabd8ae20fba53eb2be7ce11cc92ede01cdd8ba746b996c932495a2e98ca0406.js integrity="sha256-2r2K4g+6U+sr584RzJLt4Bzdi6dGuZbJMklaLpjKBAY=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a href=/><span>As long as everything adds up to one</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-d0a97e81e6c04bf86dad2e667144930c class=toggle>
<label for=section-d0a97e81e6c04bf86dad2e667144930c class="flex justify-between"><a role=button>Gsoc 2021</a></label><ul><li><a href=https://ricardov94.github.io/topics/gsoc-2021/proposal/>Proposal</a></li></ul></li></ul><ul><li><a href=/posts/>Blog</a></li></ul></nav><script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>A most unprincipled derivation of the gamma distribution</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#warmup-exercise-the-uniform-distribution>Warmup exercise: the uniform distribution</a></li><li><a href=#the-gamma-distribution>The gamma distribution</a></li><li><a href=#finding-the-normalization-constant>Finding the normalization constant</a></li><li><a href=#adding-a-scale-parameter>Adding a scale parameter</a></li><li><a href=#bonus-deriving-the-cdf-of-the-gamma-distribution>Bonus: deriving the CDF of the gamma distribution</a></li></ul></nav><script>code_show=!0;function code_toggle(){code_show=!code_show,show=code_show?"block":"none",code_blocks=document.querySelectorAll('.highlight');for(let a of code_blocks)a.style.display=show}code_toggle()</script><a class=book-btn href=javascript:code_toggle()>Toggle Code</a></aside></header><article class=markdown><h1><a href=/posts/gamma_distribution/>A most unprincipled derivation of the gamma distribution</a></h1><h5>July 13, 2021</h5><div><a href=/categories/probability/>probability</a></div><div><a href=/tags/gamma/>gamma</a>,
<a href=/tags/pdf/>pdf</a>,
<a href=/tags/cdf/>cdf</a></div><h2 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h2><p>In this article I will derive the gamma distribution in a most unprincipled way.</p><p>Why? First, there are many good resources out there explaining how to derive the gamma distribution from first principles, usually involving these idealized things called poisson processes. These are great sources and I would definitely recommend them. This one by <a href=http://archive.today/wkdwz>Aerin Kim</a> is amazing.</p><p>However, more often than not, people use gamma distributions in real world problems for much more mundane reasons: <strong>It&rsquo;s a well behaved yet flexible positive continuous distribution</strong>.</p><p>By deriving a distribution from a purely utilitarian perspective, we might get a better intuition on how and when to use it. Besides, once you go through such exercise, continuous probability distributions may start to seem a bit less magical. They may even make sense!</p><link rel=stylesheet href=/katex/katex.min.css><script defer src=/katex/katex.min.js></script><script defer src=/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>\(\)</span><p>Continuous probability distributions are mathematical objects that can be fully characterized by a probability density function (pdf). This function computes the density probability of a random outcome \(x\) given a pre-specified set of parameters. It must respect two simple constraints:</p><ol><li>Always return a non-negative density for every possible parameter and random outcome \(x\).</li><li>The density of every possible outcome \(x\), given a fixed set of parameters, must integrate to 1.</li></ol><p>To compute the probability that an event \(x\) will fall in the range \([a, b]\), we integrate the pdf over that range. The second requirement is simply saying that if \([a, b]\) corresponds to the range of all possible values of \(x\), the probability obtained from integrating the pdf must be 1. This makes sense given the convention that an event with probability of 1 corresponds to an absolutely certain event.</p><h2 id=warmup-exercise-the-uniform-distribution>Warmup exercise: the uniform distribution
<a class=anchor href=#warmup-exercise-the-uniform-distribution>#</a></h2><p>To warmup, it may help to start with what is perhaps the simplest continuous probability distribution: the uniform. This core of this distribution is the constant function</p><p>\[ uniform(x; lower, upper) = 1\]</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> <span style=color:#111>numpy</span> <span style=color:#00a8c8>as</span> <span style=color:#111>np</span>
<span style=color:#f92672>import</span> <span style=color:#111>scipy.special</span>
<span style=color:#f92672>import</span> <span style=color:#111>scipy.integrate</span>
<span style=color:#f92672>import</span> <span style=color:#111>matplotlib.pyplot</span> <span style=color:#00a8c8>as</span> <span style=color:#111>plt</span>
<span style=color:#f92672>import</span> <span style=color:#111>seaborn</span>
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>seaborn</span><span style=color:#f92672>.</span><span style=color:#111>set_style</span><span style=color:#111>(</span><span style=color:#d88200>&#39;darkgrid&#39;</span><span style=color:#111>)</span>
<span style=color:#111>seaborn</span><span style=color:#f92672>.</span><span style=color:#111>set</span><span style=color:#111>(</span><span style=color:#111>font_scale</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1.4</span><span style=color:#111>)</span>
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>uniform</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>):</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>ones_like</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>)</span>
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>plot_uniform</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>pdf</span><span style=color:#f92672>=</span><span style=color:#00a8c8>False</span><span style=color:#111>):</span>
    <span style=color:#111>y</span> <span style=color:#f92672>=</span> <span style=color:#111>f</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span>
    <span style=color:#111>area_y</span> <span style=color:#f92672>=</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>integrate</span><span style=color:#f92672>.</span><span style=color:#111>quad</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>,</span> <span style=color:#111>args</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>))[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span>
    
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>fill_between</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>alpha</span><span style=color:#f92672>=</span><span style=color:#ae81ff>.2</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>text</span><span style=color:#111>(</span>
        <span style=color:#ae81ff>0.5</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.5</span><span style=color:#111>,</span> <span style=color:#d88200>f</span><span style=color:#d88200>&#39;area=</span><span style=color:#d88200>{</span><span style=color:#111>area_y</span><span style=color:#d88200>:</span><span style=color:#d88200>.1f</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> 
        <span style=color:#111>transform</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>transAxes</span><span style=color:#111>,</span> 
        <span style=color:#111>ha</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;center&#39;</span><span style=color:#111>,</span> <span style=color:#111>va</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;center&#39;</span>
    <span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xticks</span><span style=color:#111>([</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>])</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xlabel</span><span style=color:#111>(</span><span style=color:#d88200>&#39;x&#39;</span><span style=color:#111>)</span>
    <span style=color:#00a8c8>if</span> <span style=color:#f92672>not</span> <span style=color:#111>pdf</span><span style=color:#111>:</span>
        <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;$uniform(x; </span><span style=color:#d88200>{</span><span style=color:#111>lower</span><span style=color:#d88200>}</span><span style=color:#d88200>, </span><span style=color:#d88200>{</span><span style=color:#111>upper</span><span style=color:#d88200>}</span><span style=color:#d88200>)$&#39;</span><span style=color:#111>)</span>
    <span style=color:#00a8c8>else</span><span style=color:#111>:</span>
        <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;$uniform_</span><span style=color:#8045ff>{{</span><span style=color:#d88200>pdf</span><span style=color:#8045ff>}}</span><span style=color:#d88200>(x; </span><span style=color:#d88200>{</span><span style=color:#111>lower</span><span style=color:#d88200>}</span><span style=color:#d88200>, </span><span style=color:#d88200>{</span><span style=color:#111>upper</span><span style=color:#d88200>}</span><span style=color:#d88200>)$&#39;</span><span style=color:#111>)</span>
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#ae81ff>3.5</span><span style=color:#111>))</span>

<span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span>
<span style=color:#111>plot_uniform</span><span style=color:#111>(</span><span style=color:#111>uniform</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C0&#39;</span><span style=color:#111>)</span>

<span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span><span style=color:#111>,</span> <span style=color:#ae81ff>2.5</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span>
<span style=color:#111>plot_uniform</span><span style=color:#111>(</span><span style=color:#111>uniform</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C1&#39;</span><span style=color:#111>)</span>

<span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#111>,</span> <span style=color:#ae81ff>2.5</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span>
<span style=color:#111>plot_uniform</span><span style=color:#111>(</span><span style=color:#111>uniform</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C2&#39;</span><span style=color:#111>)</span>

<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>tight_layout</span><span style=color:#111>()</span>
</code></pre></div><p><img src=output_6_0.png alt=png></p><p>This conforms to the first requirement from above: all densities for possible values of \(x\) evaluate to a non-negative number (in this case 1.0). However, the second requirement is not fulfilled. To achieve this, all we need to do is to divide our original expression by the total area</p><p>\[
\begin{aligned}
uniform_{pdf}(x; lower, upper) &= \frac{1}{\int_{lower}^{upper} 1 dx} \\
&= \frac{1}{x|_{lower}^{upper}} \\
&= \frac{1}{upper - lower} \\
\end{aligned}
\]</p><p>And now we have a proper uniform probability density function! It might seem like we cheated, but this is really all there is to it.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>uniform_pdf</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>):</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>ones_like</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>)</span> <span style=color:#f92672>/</span> <span style=color:#111>(</span><span style=color:#111>upper</span> <span style=color:#f92672>-</span> <span style=color:#111>lower</span><span style=color:#111>)</span>
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#ae81ff>3.5</span><span style=color:#111>))</span>

<span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span>
<span style=color:#111>plot_uniform</span><span style=color:#111>(</span><span style=color:#111>uniform_pdf</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>,</span> <span style=color:#111>pdf</span><span style=color:#f92672>=</span><span style=color:#00a8c8>True</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C0&#39;</span><span style=color:#111>)</span>

<span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span><span style=color:#111>,</span> <span style=color:#ae81ff>2.5</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span>
<span style=color:#111>plot_uniform</span><span style=color:#111>(</span><span style=color:#111>uniform_pdf</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>,</span> <span style=color:#111>pdf</span><span style=color:#f92672>=</span><span style=color:#00a8c8>True</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C1&#39;</span><span style=color:#111>)</span>

<span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span><span style=color:#111>,</span> <span style=color:#ae81ff>2.5</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span>
<span style=color:#111>plot_uniform</span><span style=color:#111>(</span><span style=color:#111>uniform_pdf</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>,</span> <span style=color:#111>pdf</span><span style=color:#f92672>=</span><span style=color:#00a8c8>True</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C2&#39;</span><span style=color:#111>)</span>

<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>tight_layout</span><span style=color:#111>()</span>
</code></pre></div><p><img src=output_9_0.png alt=png></p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#ae81ff>4</span><span style=color:#111>))</span>

<span style=color:#00a8c8>for</span> <span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>(</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span> <span style=color:#f92672>in</span> <span style=color:#111>enumerate</span><span style=color:#111>(</span><span style=color:#111>zip</span><span style=color:#111>((</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.5</span><span style=color:#111>,</span> <span style=color:#ae81ff>2</span><span style=color:#111>),</span> <span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>2.5</span><span style=color:#111>,</span> <span style=color:#ae81ff>2.5</span><span style=color:#111>))):</span>
    <span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span>
    <span style=color:#111>y</span> <span style=color:#f92672>=</span> <span style=color:#111>uniform_pdf</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>lower</span><span style=color:#111>,</span> <span style=color:#111>upper</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;C</span><span style=color:#d88200>{</span><span style=color:#111>i</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> <span style=color:#111>label</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;</span><span style=color:#d88200>{</span><span style=color:#111>lower</span><span style=color:#d88200>=}</span><span style=color:#d88200>, </span><span style=color:#d88200>{</span><span style=color:#111>upper</span><span style=color:#d88200>=}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>fill_between</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;C</span><span style=color:#d88200>{</span><span style=color:#111>i</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> <span style=color:#111>alpha</span><span style=color:#f92672>=</span><span style=color:#ae81ff>.2</span><span style=color:#111>)</span>

<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xlabel</span><span style=color:#111>(</span><span style=color:#d88200>&#39;x&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>&#39;$uniform_</span><span style=color:#d88200>{pdf}</span><span style=color:#d88200>(x; lower, upper)$&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>legend</span><span style=color:#111>(</span><span style=color:#111>fontsize</span><span style=color:#f92672>=</span><span style=color:#ae81ff>14</span><span style=color:#111>);</span>
</code></pre></div><p><img src=output_10_0.png alt=png></p><p>Let&rsquo;s now turn to the mightier gamma distribution.</p><h2 id=the-gamma-distribution>The gamma distribution
<a class=anchor href=#the-gamma-distribution>#</a></h2><p>The gamma distribution is based on this funny looking function, with two parameters:</p><p>\[ gamma(x; a) = x^{a-1}e^{-x} \]</p><p>We will consider the cases where \(x > 0\) and \(a > 0\). As with the uniform, \(x\) represents the possible random outcomes, while \(a\), analogous to the \(lower\) and \(upper\), is a fixed parameter that characterizes its probability density. Unlike the uniform, this distribution is not bounded, it allows for infinitely large \(x\) outcomes.</p><p>Looking at the expression, one can notice that the first part \(x^{a-1}\) will grow quickly as x goes to \(\infty\), while the second part \(e^{-x}\) will decrease exponentially as \(x\) increases. By multiplying the two we will obtain a rising curve followed by a declining one, as the two terms change in relative importance. Here is an example with \(a=4\)</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>a</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#ae81ff>100</span><span style=color:#111>)</span>

<span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#ae81ff>3.5</span><span style=color:#111>))</span>

<span style=color:#111>y1</span> <span style=color:#f92672>=</span> <span style=color:#111>x</span> <span style=color:#f92672>**</span> <span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y1</span><span style=color:#111>,</span> <span style=color:#111>lw</span><span style=color:#f92672>=</span><span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;k&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>&#39;$x^</span><span style=color:#d88200>{3}</span><span style=color:#d88200>$&#39;</span><span style=color:#111>)</span>

<span style=color:#111>y2</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>exp</span><span style=color:#111>(</span><span style=color:#f92672>-</span><span style=color:#111>x</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y2</span><span style=color:#111>,</span> <span style=color:#111>lw</span><span style=color:#f92672>=</span><span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;k&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>&#39;$e^{-x}$&#39;</span><span style=color:#111>)</span>

<span style=color:#111>y3</span> <span style=color:#f92672>=</span> <span style=color:#111>y1</span> <span style=color:#f92672>*</span> <span style=color:#111>y2</span>
<span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y3</span><span style=color:#111>,</span> <span style=color:#111>lw</span><span style=color:#f92672>=</span><span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;k&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>&#39;$x^</span><span style=color:#d88200>{3}</span><span style=color:#d88200>e^{-x}$&#39;</span><span style=color:#111>)</span>

<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>tight_layout</span><span style=color:#111>()</span>
</code></pre></div><p><img src=output_13_0.png alt=png></p><p>Let&rsquo;s turn it into a python function and see how the function changes with different \(a\).</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>gamma</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>a</span><span style=color:#111>):</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>x</span><span style=color:#f92672>**</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span><span style=color:#f92672>*</span><span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>exp</span><span style=color:#111>(</span><span style=color:#f92672>-</span><span style=color:#111>x</span><span style=color:#111>)</span>    
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>plot_gamma</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>a</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>pdf</span><span style=color:#f92672>=</span><span style=color:#00a8c8>False</span><span style=color:#111>):</span>
    <span style=color:#111>y</span> <span style=color:#f92672>=</span> <span style=color:#111>f</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>a</span><span style=color:#111>)</span>
    <span style=color:#75715e># Integrate area between 0 and +inf</span>
    <span style=color:#111>area_y</span> <span style=color:#f92672>=</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>integrate</span><span style=color:#f92672>.</span><span style=color:#111>quad</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>inf</span><span style=color:#111>,</span> <span style=color:#111>args</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>,))[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span>
    
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>fill_between</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>alpha</span><span style=color:#f92672>=</span><span style=color:#ae81ff>.2</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>text</span><span style=color:#111>(</span><span style=color:#ae81ff>0.5</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.5</span><span style=color:#111>,</span> <span style=color:#d88200>f</span><span style=color:#d88200>&#39;area=</span><span style=color:#d88200>{</span><span style=color:#111>area_y</span><span style=color:#d88200>:</span><span style=color:#d88200>.1f</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> <span style=color:#111>transform</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>transAxes</span><span style=color:#111>,</span> <span style=color:#111>ha</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;center&#39;</span><span style=color:#111>,</span> <span style=color:#111>va</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;center&#39;</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xlabel</span><span style=color:#111>(</span><span style=color:#d88200>&#39;x&#39;</span><span style=color:#111>)</span>
    <span style=color:#00a8c8>if</span> <span style=color:#f92672>not</span> <span style=color:#111>pdf</span><span style=color:#111>:</span>
        <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;$gamma(x; </span><span style=color:#d88200>{</span><span style=color:#111>a</span><span style=color:#d88200>}</span><span style=color:#d88200>)$&#39;</span><span style=color:#111>)</span>
    <span style=color:#00a8c8>else</span><span style=color:#111>:</span>
        <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;$gamma_</span><span style=color:#8045ff>{{</span><span style=color:#d88200>pdf</span><span style=color:#8045ff>}}</span><span style=color:#d88200>(x; </span><span style=color:#d88200>{</span><span style=color:#111>a</span><span style=color:#d88200>}</span><span style=color:#d88200>)$&#39;</span><span style=color:#111>)</span>
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#ae81ff>3.5</span><span style=color:#111>))</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#ae81ff>1000</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma</span><span style=color:#111>(</span><span style=color:#111>gamma</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C0&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma</span><span style=color:#111>(</span><span style=color:#111>gamma</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C1&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma</span><span style=color:#111>(</span><span style=color:#111>gamma</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#ae81ff>8</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C2&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>tight_layout</span><span style=color:#111>()</span>
</code></pre></div><p><img src=output_17_0.png alt=png></p><p>Okay, perhaps not the most amazing looking curve. But we are not looking for amazing, just nice! And there are a couple of nice things going on:</p><ol><li>The function seems to be positive everywhere in the range \(x \subset [0, \infty]\)</li><li>It looks like the graph does not blow up as \(x\) goes to \(\infty\), even for larger \(a\)</li><li>The \(a\) parameter seems to have a meaningful effect on the shape of the function.</li></ol><p>Points 1 and 2 are needed for defining an unbounded positive probability density function, while point 3 is nice for making it a useful distribution.</p><blockquote class="book-hint info"><p>If you never heard about the gamma function, you might be surprised to find out that the areas for the three examples all evaluate to integer values (subject to float representation). Even more surprising is the fact that these values correspond to \((a-1)!\). And analogous to the factorial function, the area under this expression preserves a certain recursive form of \(n! = n(n-1)!\), for any positive numbers (while the factorial is only defined for integers). This surprising fact was discovered by <a href=https://en.wikipedia.org/wiki/Gamma_function#History>Euler in 1730</a>.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>math</span><span style=color:#f92672>.</span><span style=color:#111>factorial</span><span style=color:#111>(</span><span style=color:#ae81ff>3</span><span style=color:#111>),</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>math</span><span style=color:#f92672>.</span><span style=color:#111>factorial</span><span style=color:#111>(</span><span style=color:#ae81ff>5</span><span style=color:#111>),</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>math</span><span style=color:#f92672>.</span><span style=color:#111>factorial</span><span style=color:#111>(</span><span style=color:#ae81ff>7</span><span style=color:#111>)</span>
</code></pre></div><pre><code>(6, 120, 5040)
</code></pre><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>special</span><span style=color:#f92672>.</span><span style=color:#111>gamma</span><span style=color:#111>(</span><span style=color:#ae81ff>3.5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#ae81ff>3.5</span> <span style=color:#f92672>*</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>special</span><span style=color:#f92672>.</span><span style=color:#111>gamma</span><span style=color:#111>(</span><span style=color:#ae81ff>3.5</span><span style=color:#111>)</span>
</code></pre></div><pre><code>(11.63172839656745, 11.63172839656745)
</code></pre></blockquote><h2 id=finding-the-normalization-constant>Finding the normalization constant
<a class=anchor href=#finding-the-normalization-constant>#</a></h2><p>In order to obtain a valid density function, we must be able to scale this function so that it integrates to 1. In theory, all we need to do is divide the original expression by the total area, as we did for the uniform.</p><p>\[ gamma_{pdf}(x; a) = \frac{x^{a-1}e^{-x}}{\int_{0}^{\infty}{x^{a-1} e^{-x} dx}} \]</p><p>However, unlike the uniform, there is no simple form for the integral in the denominator. That might be slightly annoying, but it&rsquo;s not critical as long as we can compute it. In the code used to generate the plots above, I used a generic integration approximator, but, fortunately for us, some folks have found more reliable or accurate approximations that can be used to compute this integral (see the Wikipedia entries for <a href=https://en.wikipedia.org/wiki/Stirling%27s_approximation>Stirling&rsquo;s</a> and <a href=https://en.wikipedia.org/wiki/Lanczos_approximation>Lanczos&rsquo;s</a> approximations).</p><p>Finally, just because we cannot simplify the denominator expression, it doesn&rsquo;t mean we have to write it everywhere. Let&rsquo;s do some mathematical refactoring by encapsulating the denominator inside a function. To keep it math-appropriate we will use a Greek letter for its name, although something more verbose such as <code>total_area_gamma</code> would work as well. To keep with the convention, we will give it the uppercase gamma symbol \(\Gamma\):</p><p>\[ gamma_{pdf}(x; a) = \frac{x^{a-1}e^{-x}}{\Gamma(a)} \]</p><blockquote class="book-hint info">Scipy provides an implementation of the gamma function via <code>scipy.special.gamma</code>.</blockquote><p>Time to plot our proper gamma density function:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>gamma_pdf</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>a</span><span style=color:#111>):</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>x</span><span style=color:#f92672>**</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span><span style=color:#f92672>*</span><span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>exp</span><span style=color:#111>(</span><span style=color:#f92672>-</span><span style=color:#111>x</span><span style=color:#111>)</span> <span style=color:#f92672>/</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>special</span><span style=color:#f92672>.</span><span style=color:#111>gamma</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>)</span> 
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#ae81ff>3.5</span><span style=color:#111>))</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#ae81ff>1000</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma</span><span style=color:#111>(</span><span style=color:#111>gamma_pdf</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#111>pdf</span><span style=color:#f92672>=</span><span style=color:#00a8c8>True</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C0&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma</span><span style=color:#111>(</span><span style=color:#111>gamma_pdf</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#111>pdf</span><span style=color:#f92672>=</span><span style=color:#00a8c8>True</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C1&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma</span><span style=color:#111>(</span><span style=color:#111>gamma_pdf</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#ae81ff>8</span><span style=color:#111>,</span> <span style=color:#111>pdf</span><span style=color:#f92672>=</span><span style=color:#00a8c8>True</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C2&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>tight_layout</span><span style=color:#111>()</span>
</code></pre></div><p><img src=output_25_0.png alt=png></p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#ae81ff>4</span><span style=color:#111>))</span>

<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#ae81ff>1000</span><span style=color:#111>)</span>
<span style=color:#00a8c8>for</span> <span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>a</span> <span style=color:#f92672>in</span> <span style=color:#111>enumerate</span><span style=color:#111>((</span><span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#ae81ff>8</span><span style=color:#111>)):</span>
    <span style=color:#111>y</span> <span style=color:#f92672>=</span> <span style=color:#111>gamma_pdf</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>a</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;C</span><span style=color:#d88200>{</span><span style=color:#111>i</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> <span style=color:#111>label</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;</span><span style=color:#d88200>{</span><span style=color:#111>a</span><span style=color:#d88200>=}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>fill_between</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;C</span><span style=color:#d88200>{</span><span style=color:#111>i</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> <span style=color:#111>alpha</span><span style=color:#f92672>=</span><span style=color:#ae81ff>.2</span><span style=color:#111>)</span>

<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xlabel</span><span style=color:#111>(</span><span style=color:#d88200>&#39;x&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>&#39;gamma_pdf(x; a)&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>legend</span><span style=color:#111>();</span>
</code></pre></div><p><img src=output_26_0.png alt=png></p><h2 id=adding-a-scale-parameter>Adding a scale parameter
<a class=anchor href=#adding-a-scale-parameter>#</a></h2><p>Our pdf is neat, but can we do something more with it? Most distributions have two parameters, and we got only one: \(a\). Since more flexibility can always come in handy, why not add another one? What about adding a scaling \(b\) parameter?</p><p>According to <a href=https://en.wikipedia.org/wiki/Scale_parameter>Wikipedia</a>, this is pretty straightforward once we have a valid pdf, which we already do:</p><p>\[ scaled_{pdf}(x, b) = \frac{1}{b}standard_{pdf}(\frac{x}{b}) \]</p><p>In our case</p><p>\[ gamma_{pdf}(x; a, b) = \frac{(\frac{x}{b})^{a-1} e^{-(\frac{x}{b})}}{b \Gamma(a)} \]</p><p>Which we can arrange as</p><p>\[ gamma_{pdf}(x; a, b) = \frac{x^{a-1} e^{-(\frac{x}{b})}}{b^{a-1}b \Gamma(a)} = \frac{x^{a-1} e^{-(\frac{x}{b})}}{b^{a} \Gamma(a)} \]</p><p>Or alternatively, we can use a precision variable \(c = \frac{1}{b}\)</p><p>\[ gamma_{pdf}(x; a, c) = \frac{c(xc)^{a-1} e^{-(xc)}}{\Gamma(a)} = \frac{c^ax^{a-1} e^{-xc}}{\Gamma(a)} \]</p><p>Let&rsquo;s see what we can do with this extra parameter:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>gamma_pdf</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>a</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#111>):</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>c</span><span style=color:#f92672>**</span><span style=color:#111>a</span> <span style=color:#f92672>*</span> <span style=color:#111>x</span><span style=color:#f92672>**</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#f92672>*</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>exp</span><span style=color:#111>(</span><span style=color:#f92672>-</span><span style=color:#111>x</span><span style=color:#f92672>*</span><span style=color:#111>c</span><span style=color:#111>)</span> <span style=color:#f92672>/</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>special</span><span style=color:#f92672>.</span><span style=color:#111>gamma</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>)</span>
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>plot_gamma_variations</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#111>):</span>
    <span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>linspace</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#ae81ff>1000</span><span style=color:#111>)</span>
    <span style=color:#111>base_color</span> <span style=color:#f92672>=</span> <span style=color:#111>seaborn</span><span style=color:#f92672>.</span><span style=color:#111>saturate</span><span style=color:#111>(</span><span style=color:#111>color</span><span style=color:#111>)</span>

    <span style=color:#00a8c8>for</span> <span style=color:#111>c</span><span style=color:#111>,</span> <span style=color:#111>saturation</span> <span style=color:#f92672>in</span> <span style=color:#111>zip</span><span style=color:#111>((</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.5</span><span style=color:#111>),</span> <span style=color:#111>(</span><span style=color:#ae81ff>0.8</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.4</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.2</span><span style=color:#111>)):</span>
        <span style=color:#111>y</span> <span style=color:#f92672>=</span> <span style=color:#111>gamma_pdf</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>a</span><span style=color:#f92672>=</span><span style=color:#111>a</span><span style=color:#111>,</span> <span style=color:#111>c</span><span style=color:#f92672>=</span><span style=color:#111>c</span><span style=color:#111>)</span>
        <span style=color:#111>color</span> <span style=color:#f92672>=</span> <span style=color:#111>seaborn</span><span style=color:#f92672>.</span><span style=color:#111>desaturate</span><span style=color:#111>(</span><span style=color:#111>base_color</span><span style=color:#111>,</span> <span style=color:#111>saturation</span><span style=color:#111>)</span>
        <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>label</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;</span><span style=color:#d88200>{</span><span style=color:#111>c</span><span style=color:#d88200>=}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
        <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>fill_between</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>alpha</span><span style=color:#f92672>=</span><span style=color:#ae81ff>.2</span><span style=color:#111>)</span>

    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xlabel</span><span style=color:#111>(</span><span style=color:#d88200>&#39;x&#39;</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;$gamma_</span><span style=color:#8045ff>{{</span><span style=color:#d88200>pdf</span><span style=color:#8045ff>}}</span><span style=color:#d88200>(x;</span><span style=color:#d88200>{</span><span style=color:#111>a</span><span style=color:#d88200>}</span><span style=color:#d88200>,c)$&#39;</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>legend</span><span style=color:#111>()</span>
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#ae81ff>3.5</span><span style=color:#111>))</span>
<span style=color:#111>plot_gamma_variations</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>=</span><span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C0&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma_variations</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>=</span><span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C1&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma_variations</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>=</span><span style=color:#ae81ff>8</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C2&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>tight_layout</span><span style=color:#111>()</span>
</code></pre></div><p><img src=output_30_0.png alt=png></p><blockquote class="book-hint info">The parameter names \(a\), \(b\), and \(c\), deviate from traditional characterizations of the gamma distribution. <a href=https://en.wikipedia.org/wiki/Gamma_distribution#Definitions>Wikipedia</a>, for example, uses \(k\) and \(\theta\) for our \(a\) and scale \(b\), and a distinct pair of parameter names \(\alpha\) and \(\beta\) for our \(a\) and precision \(c\) parameterization. \(\lambda\) is also commonly used for the precision parameter, as this is linked conceptually to the exponential \(\lambda\) rate parameter. Speaking of which, &ldquo;rate&rdquo; is an alternative, and perhaps more common name, for &ldquo;precision&rdquo;.</blockquote><h2 id=bonus-deriving-the-cdf-of-the-gamma-distribution>Bonus: deriving the CDF of the gamma distribution
<a class=anchor href=#bonus-deriving-the-cdf-of-the-gamma-distribution>#</a></h2><p>We got the gamma pdf, let&rsquo;s get the cumulative distribution function (CDF) as well. Recall that the CDF of a distribution \(X\) is the matematical function that returns the \(P(X&lt;=x)\), that is the probability that the random \(x\) value is lower or equal to a specific number. Since it defines an interval, in our case \([0, x]\), it is appropriate to talk about probabilities and not just densities.</p><p>\[ gamma\_cdf(x; a, c) = \frac{\int_0^x c^a(u)^{a-1} e^{-(cu)} du}{\Gamma(a)}\]</p><p>Note that we need a new variable \(u\) to distinguish the limit of integration from the integrand.
Also, for the very same reason as before, the \(\Gamma(a)\) is there to make sure the CDF evaluates to \(1\) when \(x=\infty\)</p><blockquote class="book-hint info">This article would have been slightly less unrealistic if it had started with the derivation of the CDF, since the Gamma integral function is what actually came down to us through history.</blockquote><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>plot_gamma_integral</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>cdf</span><span style=color:#f92672>=</span><span style=color:#00a8c8>False</span><span style=color:#111>):</span>
    <span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>logspace</span><span style=color:#111>(</span><span style=color:#ae81ff>0.1</span><span style=color:#111>,</span> <span style=color:#ae81ff>1.3</span><span style=color:#111>)</span>
    <span style=color:#111>y</span> <span style=color:#f92672>=</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>special</span><span style=color:#f92672>.</span><span style=color:#111>gammainc</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>)</span>
    <span style=color:#111>assymptote</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
    <span style=color:#75715e># gammainc returns the already normalized incomplete integral</span>
    <span style=color:#111>gamma</span> <span style=color:#f92672>=</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>special</span><span style=color:#f92672>.</span><span style=color:#111>gamma</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>)</span>
    <span style=color:#111>y</span> <span style=color:#f92672>*=</span> <span style=color:#111>gamma</span>
    
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>fill_between</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>alpha</span><span style=color:#f92672>=</span><span style=color:#ae81ff>.2</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_yticks</span><span style=color:#111>([</span><span style=color:#111>gamma</span><span style=color:#111>])</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>grid</span><span style=color:#111>(</span><span style=color:#00a8c8>None</span><span style=color:#111>,</span> <span style=color:#111>axis</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;x&#39;</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xlabel</span><span style=color:#111>(</span><span style=color:#d88200>&#39;x&#39;</span><span style=color:#111>)</span>
    
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;$\int_0^</span><span style=color:#8045ff>{{</span><span style=color:#d88200>x</span><span style=color:#8045ff>}}</span><span style=color:#d88200>gamma(u; </span><span style=color:#d88200>{</span><span style=color:#111>a</span><span style=color:#d88200>}</span><span style=color:#d88200>, 1) du$&#39;</span><span style=color:#111>)</span>
</code></pre></div><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#ae81ff>3.5</span><span style=color:#111>))</span>
<span style=color:#111>plot_gamma_integral</span><span style=color:#111>(</span><span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C0&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma_integral</span><span style=color:#111>(</span><span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C1&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plot_gamma_integral</span><span style=color:#111>(</span><span style=color:#ae81ff>8</span><span style=color:#111>,</span> <span style=color:#111>ax</span><span style=color:#f92672>=</span><span style=color:#111>ax</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;C2&#39;</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>tight_layout</span><span style=color:#111>()</span>
</code></pre></div><p><img src=output_35_0.png alt=png></p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#ae81ff>4</span><span style=color:#111>))</span>

<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>logspace</span><span style=color:#111>(</span><span style=color:#ae81ff>0.1</span><span style=color:#111>,</span> <span style=color:#ae81ff>1.3</span><span style=color:#111>)</span>
<span style=color:#00a8c8>for</span> <span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>a</span> <span style=color:#f92672>in</span> <span style=color:#111>enumerate</span><span style=color:#111>((</span><span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#ae81ff>8</span><span style=color:#111>)):</span>
    <span style=color:#111>y</span> <span style=color:#f92672>=</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>special</span><span style=color:#f92672>.</span><span style=color:#111>gammainc</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;C</span><span style=color:#d88200>{</span><span style=color:#111>i</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> <span style=color:#111>label</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;</span><span style=color:#d88200>{</span><span style=color:#111>a</span><span style=color:#d88200>=}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>fill_between</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;C</span><span style=color:#d88200>{</span><span style=color:#111>i</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> <span style=color:#111>alpha</span><span style=color:#f92672>=</span><span style=color:#ae81ff>.2</span><span style=color:#111>)</span>

<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xlabel</span><span style=color:#111>(</span><span style=color:#d88200>&#39;x&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;$gamma_</span><span style=color:#8045ff>{{</span><span style=color:#d88200>cdf</span><span style=color:#8045ff>}}</span><span style=color:#d88200>(x; a, 1)$&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>legend</span><span style=color:#111>();</span>
</code></pre></div><p><img src=output_36_0.png alt=png></p><p>The CDF expression can be further simplified with a change of variables \(t = cu\)
\[
\begin{aligned}
gamma\_cdf(x; a, c) &= \frac{\int_0^x c^a(u)^{a-1} e^{-(cu)} du}{\Gamma(a)} \\
&= \frac{1}{\Gamma(a)} \int_0^x c(cu)^{a-1} e^{-(cu)} du \\
&= \frac{1}{\Gamma(a)} \int_0^{xc} c(t)^{a-1} e^{-t} \frac{1}{c}dt \quad
\begin{cases}
\text{change of variables} \\
t = cu \\
dt = c\,du \\
\frac{1}{c}dt = du \\
\end{cases} \\
&= \frac{1}{\Gamma(a)} \int_0^{xc} t^{a-1} e^{-t} dt
\end{aligned}
\]</p><p>Which reveals that the inverse scaling by \(c\) has an effect on increasing or reducing the area of a standard gamma distribution that is contained below \(x\)</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>_</span><span style=color:#111>,</span> <span style=color:#111>ax</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplots</span><span style=color:#111>(</span><span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#ae81ff>4</span><span style=color:#111>))</span>
<span style=color:#111>x</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>logspace</span><span style=color:#111>(</span><span style=color:#ae81ff>0.1</span><span style=color:#111>,</span> <span style=color:#ae81ff>1.6</span><span style=color:#111>,</span> <span style=color:#ae81ff>200</span><span style=color:#111>)</span>

<span style=color:#111>base_color</span> <span style=color:#f92672>=</span> <span style=color:#111>seaborn</span><span style=color:#f92672>.</span><span style=color:#111>saturate</span><span style=color:#111>(</span><span style=color:#d88200>&#39;C0&#39;</span><span style=color:#111>)</span>
<span style=color:#111>cutoff</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>

<span style=color:#00a8c8>for</span> <span style=color:#111>c</span><span style=color:#111>,</span> <span style=color:#111>saturation</span> <span style=color:#f92672>in</span> <span style=color:#111>zip</span><span style=color:#111>(</span>
    <span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.5</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.25</span><span style=color:#111>),</span>
    <span style=color:#111>(</span><span style=color:#ae81ff>0.8</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.4</span><span style=color:#111>,</span> <span style=color:#ae81ff>0.2</span><span style=color:#111>)</span>
<span style=color:#111>):</span>
    <span style=color:#111>color</span> <span style=color:#f92672>=</span> <span style=color:#111>seaborn</span><span style=color:#f92672>.</span><span style=color:#111>desaturate</span><span style=color:#111>(</span><span style=color:#111>base_color</span><span style=color:#111>,</span> <span style=color:#111>saturation</span><span style=color:#111>)</span>
    <span style=color:#111>where</span> <span style=color:#f92672>=</span> <span style=color:#111>x</span><span style=color:#f92672>&lt;=</span><span style=color:#111>(</span><span style=color:#111>cutoff</span><span style=color:#f92672>/</span><span style=color:#111>c</span><span style=color:#111>)</span>
    
    <span style=color:#111>y</span> <span style=color:#f92672>=</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>special</span><span style=color:#f92672>.</span><span style=color:#111>gammainc</span><span style=color:#111>(</span><span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#111>x</span><span style=color:#f92672>*</span><span style=color:#111>c</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>[</span><span style=color:#111>where</span><span style=color:#111>],</span> <span style=color:#111>y</span><span style=color:#111>[</span><span style=color:#111>where</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>label</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;</span><span style=color:#d88200>{</span><span style=color:#111>c</span><span style=color:#d88200>=}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>plot</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>[</span><span style=color:#f92672>~</span><span style=color:#111>where</span><span style=color:#111>],</span> <span style=color:#111>y</span><span style=color:#111>[</span><span style=color:#f92672>~</span><span style=color:#111>where</span><span style=color:#111>],</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>ls</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;--&#39;</span><span style=color:#111>)</span>
    <span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>fill_between</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>,</span> <span style=color:#111>y</span><span style=color:#111>,</span> <span style=color:#111>where</span><span style=color:#f92672>=</span><span style=color:#111>where</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>,</span> <span style=color:#111>alpha</span><span style=color:#f92672>=</span><span style=color:#ae81ff>.2</span><span style=color:#111>)</span>

<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xticks</span><span style=color:#111>([</span><span style=color:#ae81ff>5</span><span style=color:#111>,</span> <span style=color:#ae81ff>10</span><span style=color:#111>,</span> <span style=color:#ae81ff>20</span><span style=color:#111>])</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_yticks</span><span style=color:#111>([</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>scipy</span><span style=color:#f92672>.</span><span style=color:#111>special</span><span style=color:#f92672>.</span><span style=color:#111>gammainc</span><span style=color:#111>(</span><span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#111>cutoff</span><span style=color:#111>),</span> <span style=color:#ae81ff>1</span><span style=color:#111>])</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_xlabel</span><span style=color:#111>(</span><span style=color:#d88200>&#39;x&#39;</span><span style=color:#111>)</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>set_title</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;$gamma_</span><span style=color:#8045ff>{{</span><span style=color:#d88200>cdf</span><span style=color:#8045ff>}}</span><span style=color:#d88200>(x; 4, c)$&#39;</span><span style=color:#111>)</span>
<span style=color:#75715e># ax.set_ylabel(r&#39;$\frac{\int_0^{xc}{f(a, u)} du}{area\_f(x)}$&#39;)</span>
<span style=color:#111>ax</span><span style=color:#f92672>.</span><span style=color:#111>legend</span><span style=color:#111>();</span>
</code></pre></div><p><img src=output_38_0.png alt=png></p><p>Similar to what we did with the pdf, it&rsquo;s common to refactor the numerator integral expression into its own function. This is called lower incomplete gamma function, or more succintly the lower case gamma \(\gamma\) letter.
\[
gamma\_cdf(x; a, c) = \frac{\int_0^{xc} t^{a-1} e^{-t} dt}{\Gamma(a)} = \frac{\gamma(a, xc)}{\Gamma(a)}
\]</p><blockquote class="book-hint info">As with the gamma function, there are quick and stable numerical implementations of the incomplete gamma function. In scipy this can be obtained by <code>scipy.special.gammainc(a, x) * scipy.special.gamma(a)</code>. The multiplication is needed because the default <code>scipy.special.gammainc</code> already contains the \(gamma(a)\) normalization term.</blockquote><blockquote class="book-hint info">Similarly to the gamma distribution, which gets its name from the gamma integral function \(\Gamma\), the beta distribution also gets its name from the beta integral function \(B\). In fact the two distributions are closely related.</blockquote><div class=hide style=display:none>nb2hugo ~/Documents/ricardoV94.github.io.website/raw_notebooks/gamma_distribution.ipynb --site-dir ~/Documents/ricardoV94.github.io.website/ --section posts</div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/ricardoV94/ricardoV94.github.io.website/edit/master/content/posts/gamma_distribution.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#warmup-exercise-the-uniform-distribution>Warmup exercise: the uniform distribution</a></li><li><a href=#the-gamma-distribution>The gamma distribution</a></li><li><a href=#finding-the-normalization-constant>Finding the normalization constant</a></li><li><a href=#adding-a-scale-parameter>Adding a scale parameter</a></li><li><a href=#bonus-deriving-the-cdf-of-the-gamma-distribution>Bonus: deriving the CDF of the gamma distribution</a></li></ul></nav><script>code_show=!0;function code_toggle(){code_show=!code_show,show=code_show?"block":"none",code_blocks=document.querySelectorAll('.highlight');for(let a of code_blocks)a.style.display=show}code_toggle()</script><a class=book-btn href=javascript:code_toggle()>Toggle Code</a></div></aside></main></body></html>