<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="PyMC3: Make SMC-ABC faster and more flexible #  Intro #  PyMC3 provides state-of-the-art tools to specify rich mathematical probabilistic models and algorithms to efficiently approximate the posterior distribution of such models conditioned on observed data. One such algorithm is the Sequential Monte Carlo (SMC) sampler which is capable of drawing samples from complex posterior distributions (e.g., multimodal distributions).
In addition to traditional Bayesian inference, SMC can also be used to perform Approximate Bayesian Computation (ABC), which allows one to define models without a pure mathematical likelihood term, which is difficult to derive in many complex real world problems.">
<meta name=theme-color content="#FFFFFF"><meta property="og:title" content>
<meta property="og:description" content="PyMC3: Make SMC-ABC faster and more flexible #  Intro #  PyMC3 provides state-of-the-art tools to specify rich mathematical probabilistic models and algorithms to efficiently approximate the posterior distribution of such models conditioned on observed data. One such algorithm is the Sequential Monte Carlo (SMC) sampler which is capable of drawing samples from complex posterior distributions (e.g., multimodal distributions).
In addition to traditional Bayesian inference, SMC can also be used to perform Approximate Bayesian Computation (ABC), which allows one to define models without a pure mathematical likelihood term, which is difficult to derive in many complex real world problems.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ricardov94.github.io/topics/gsoc-2021/proposal/"><meta property="article:section" content="topics">
<title>Proposal | As long as everything adds up to one</title>
<link rel=manifest href=/manifest.json>
<link rel=icon href=/favicon.png type=image/x-icon>
<link rel=stylesheet href=/book.min.336536302c9333426b2435f844b8628561bae88f21fec7883f90118e27d33980.css integrity="sha256-M2U2MCyTM0JrJDX4RLhihWG66I8h/seIP5ARjifTOYA=" crossorigin=anonymous>
<script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.a839a23f184e1dbda5a239f19360a272bfa26e25271bdad2c839a0479f70019f.js integrity="sha256-qDmiPxhOHb2lojnxk2Cicr+ibiUnG9rSyDmgR59wAZ8=" crossorigin=anonymous></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a href=/><span>As long as everything adds up to one</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li>
<input type=checkbox id=section-d0a97e81e6c04bf86dad2e667144930c class=toggle checked>
<label for=section-d0a97e81e6c04bf86dad2e667144930c class="flex justify-between">
<a role=button>Gsoc 2021</a>
</label>
<ul>
<li>
<a href=https://ricardov94.github.io/topics/gsoc-2021/proposal/ class=active>Proposal</a>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<a href=/posts/>
Blog
</a>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Proposal</strong>
<label for=toc-control>
<img src=/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#intro>Intro</a></li>
<li><a href=#technical-details>Technical Details</a></li>
<li><a href=#phase-1>Phase 1</a></li>
<li><a href=#phase-2>Phase 2</a></li>
<li><a href=#phase-3>Phase 3</a></li>
<li><a href=#community-bonding-period>Community Bonding Period</a></li>
<li><a href=#why-me>Why Me?</a></li>
<li><a href=#why-pymc3>Why PyMC3?</a></li>
<li><a href=#references>References</a></li>
</ul>
</nav>
<script>code_show=!0;function code_toggle(){code_show=!code_show,show=code_show?"block":"none",code_blocks=document.querySelectorAll(':not(.never-hide) > .highlight');for(let a of code_blocks)a.style.display=show}code_toggle()</script>
<a class=book-btn href=javascript:code_toggle()>Toggle Code</a>
</aside>
</header>
<article class=markdown><h1 id=pymc3-make-smc-abc-faster-and-more-flexible>
PyMC3: Make SMC-ABC faster and more flexible
<a class=anchor href=#pymc3-make-smc-abc-faster-and-more-flexible>#</a>
</h1>
<h2 id=intro>
Intro
<a class=anchor href=#intro>#</a>
</h2>
<p>PyMC3 provides state-of-the-art tools to specify rich mathematical probabilistic models and algorithms to efficiently approximate the posterior distribution of such models conditioned on observed data. One such algorithm is the Sequential Monte Carlo (SMC) sampler which is capable of drawing samples from complex posterior distributions (e.g., multimodal distributions).</p>
<p>In addition to traditional Bayesian inference, SMC can also be used to perform Approximate Bayesian Computation (ABC), which allows one to define models without a pure mathematical likelihood term, which is difficult to derive in many complex real world problems. To achieve this, SMC-ABC makes use of a “Simulator” function that is capable of returning simulated observed data given different unobserved parameters.</p>
<p>This project seeks to extend the documentation, performance and flexibility of SMC and SMC-ABC sampling in PyMC3, to make it competitive with specialized libraries while remaining accessible to the large user-base of the PyMC3 library.</p>
<h2 id=technical-details>
Technical Details
<a class=anchor href=#technical-details>#</a>
</h2>
<p>This project involves making improvements to the SMC(-ABC) sampler in the light of the recent changes to the Aesara backend in the upcoming V4 release. This ongoing transition involves a large change to the library codebase and it is likely that some features of SMC(-ABC) may be broken in the process.</p>
<h2 id=phase-1>
Phase 1
<a class=anchor href=#phase-1>#</a>
</h2>
<p><em>Weeks 1 - 3 (June 7th - June 27th)</em></p>
<p>As such, the first phase of the project will focus on fixing any potential regressions, while aligning the code logic to be more in line with the core library after the V4 transition. Some prior issues that were detected through personal experimentation and user discussions will also be tackled during this initial phase:</p>
<ul>
<li>Wrap the pm.Simulator object around RandomOps for a more consistent integration within the PyMC3 model object</li>
<li>Fix currently broken Prior and Posterior predictive sampling when using pm.Simulator</li>
<li>Fix currently broken graphviz representation when using Pm.Simulator</li>
<li>Allow pm.Simulator wrapped function to take non-named inputs and provide more useful error messages for improper initialization (see discourse issue)</li>
<li>Add progress bar in each beta stage for better visual feedback of sampling speed during SMC</li>
<li>Automatically select SMC-ABC when pm.Simulator is present in a Model object</li>
<li>Fix missing documentation for pm.Simulator</li>
<li>Test possibility for improved performance via vectorized evaluation of the graph logp across SMC particles</li>
<li>Test parallel sampling in SMC and provide that as default.</li>
</ul>
<h2 id=phase-2>
Phase 2
<a class=anchor href=#phase-2>#</a>
</h2>
<p><em>Weeks 4-6 (June 28th - July 18th)</em></p>
<p>In the second phase of this project, the core SMC-ABC functions will be refactored to increase its modularity and facilitate the implementation and testing of different algorithms going into the future. During this time I also plan to write 3 in-depth PyMC-examples that demonstrate the use of SMC(-ABC) in PyMC3. These include:</p>
<ul>
<li>Definition of a consistent API based on python functions with standard I/O that can be plugged in at the different stages of SMC: initialize_population, mutate, tune, etc&mldr; for customization of the sampling algorithm.</li>
<li>Provide two standard SMC algorithms: Independent MvNormal (already implemented in v3), and Normal random walk (reintroduced for benchmarking and assessing modularity of the SMC-ABC functionality)</li>
<li>Add a Probability Density Approximation (PDA) method based on a Gaussian or Epanechnikov kernel as an alternative to the epsilon based distance Pseudo-likelihood (Turner & Sederberg, 2014).</li>
<li>Documentation for all changes</li>
<li>Write 3 new PyMC-examples that illustrate SMC(-ABC) features:
<ul>
<li>Adapt and extend toy example from Bååth (2014) which emphasizes the advantages and disadvantages of ABC sampling (need to derive complex likelihoods vs speed / accuracy).</li>
<li>Contrast the accuracy of ABC vs true-likelihood sampling in simple Cognitive research models with known Likelihood forms described in Palestro et al., (2018).</li>
<li>Tutorial on how to implement a custom SMC-kernel (Independent Metropolis Hastings with mixture of gaussians) to facilitate future research and development of SMC(-ABC) in PyMC3.</li>
</ul>
</li>
</ul>
<h2 id=phase-3>
Phase 3
<a class=anchor href=#phase-3>#</a>
</h2>
<p><em>Weeks 7-10 (July 19th - August 15th)</em></p>
<p>The third and final phase of the project will explore promising extensions of SMC(-ABC) beyond what is currently offered in the PyMC3 library. Namely:</p>
<ul>
<li>Proof of concept SMC sampling with NUTS kernel for updating of particles.</li>
<li>Combination of Simulator with normal NUTS blocked sampling by updating first order parameters with the ABC Pseudolikelihood, and hyperparameters that do not feed directly into the (Pseudo-)Likelihood with NUTS (a.k.a, Hierarchical Gibbs Sampling, see Turner & van Zandt, 2014)</li>
<li>Allow for multiple Simulators within a single model (e.g., in a hierarchical model where one might want to use different epsilon levels for different observations/ users)</li>
<li>Allow the Mixing of Simulator Pseudo-likelihoods and True-likelihoods in a single model.</li>
</ul>
<h2 id=community-bonding-period>
Community Bonding Period
<a class=anchor href=#community-bonding-period>#</a>
</h2>
<p><em>(May 17 - June 7)</em></p>
<p>I plan to make use of the Community Bonding Period to further refine the goals of my project with the supervisors and core-developer team. During this time I plan to reach out to the PyMC3 user community (via <a href=https://discourse.pymc.io/>https://discourse.pymc.io/</a>) to elicit feedback and suggestions on the proposal. Finally, during this phase I will launch a monthly code-sharing “contest” where users can submit and review PyMC3 models that highlight interesting library features as well as general statistical and theoretical ideas that arise in the practice of bayesian modelling and inference.</p>
<h2 id=why-me>
Why Me?
<a class=anchor href=#why-me>#</a>
</h2>
<p>I am a PhD Student in the field of Cognitive Science, and enthusiast self-taught statistician. I am interested in the features of Bayesian models not only as a useful statistical tool for research data analysis but also as a model of human and animal cognition. In addition, I am a fan of the Python language and I have been learning, using it and teaching it for 6 years.
Development Experience</p>
<p>I have been an active contributor to the PyMC3 library since last December, having used the library extensively in research for nearly 2 years now. I became an official core-developer around January 2021, and I have engaged with the project and community extensively since and prior to that. A few of my (merged) PRs are listed below:</p>
<p>New functionalities:</p>
<ul>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4419>#4419</a>: Add informative user Warning when doing prior/posterior predictive sampling in models with arbitrary Potentials</li>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4407>#4407</a>: Increase numerical stability of ExGaussian logp and logcdf methods</li>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4387>#4387</a>: Implement logcdf methods for discrete distributions</li>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4373>#4373</a>: Complete stale DirichletMultinomial distribution PR</li>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4360>#4360</a>: Improve <code>math.logsumexp</code> to work with infinite values</li>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4298>#4298</a>: Make jitter during initializations of NUTS more robust</li>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4314>#4134</a>: Add parameterizations to NegativeBinomial in terms of <code>n</code> and <code>p</code></li>
</ul>
<p>Testing:</p>
<ul>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4461>#4461</a>: Unseed wrongly seeded tests</li>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4448>#4448</a>: Add tests for difficult to debug bugs</li>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4393>#4393</a>: Make logcdf tests more exhaustive</li>
</ul>
<p>Minor bugfixes:</p>
<ul>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4366>#4366</a></li>
<li><a href=https://github.com/pymc-devs/pymc3/pull/4211>#4211</a></li>
</ul>
<h2 id=why-pymc3>
Why PyMC3?
<a class=anchor href=#why-pymc3>#</a>
</h2>
<p>PyMC3 provides easy access to state-of-the-art tools to perform Bayesian inference. I have used this library extensively during my research and teaching, and found it invaluable within the Python (and Bayesian) ecosystem. It’s simple syntax, extensive documentation and large active community make it easy for beginners to transition into Bayesian analysis, which is increasingly viewed as a more principled and more fool-proof way of performing statistical analysis and informed decision making in research and industry settings.</p>
<h2 id=references>
References
<a class=anchor href=#references>#</a>
</h2>
<ol>
<li>Bååth, R (2014). Tiny Data, Approximate Bayesian Computation and the Socks of Karl Broman. <a href=http://www.sumsar.net/blog/2014/10/tiny-data-and-the-socks-of-karl-broman/>http://www.sumsar.net/blog/2014/10/tiny-data-and-the-socks-of-karl-broman/</a></li>
<li>Palestro, J. J., Sederberg, P. B., Osth, A. F., Van Zandt, T., & Turner, B. M. (2018). Likelihood-free methods for cognitive science. Springer International Publishing.</li>
<li>Turner, B. M., & Sederberg, P. B. (2014). A generalized, likelihood-free method for posterior estimation. Psychonomic bulletin & review, 21(2), 227-250.</li>
<li>Turner, B. M., & Van Zandt, T. (2014). Hierarchical approximate Bayesian computation. Psychometrika, 79(2), 185-209.</li>
</ol>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
<div>
<a class="flex align-center" href=https://github.com/ricardoV94/ricardoV94.github.io.website/edit/master/content/topics/gsoc-2021/proposal.md target=_blank rel=noopener>
<img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span>
</a>
</div>
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#intro>Intro</a></li>
<li><a href=#technical-details>Technical Details</a></li>
<li><a href=#phase-1>Phase 1</a></li>
<li><a href=#phase-2>Phase 2</a></li>
<li><a href=#phase-3>Phase 3</a></li>
<li><a href=#community-bonding-period>Community Bonding Period</a></li>
<li><a href=#why-me>Why Me?</a></li>
<li><a href=#why-pymc3>Why PyMC3?</a></li>
<li><a href=#references>References</a></li>
</ul>
</nav>
<script>code_show=!0;function code_toggle(){code_show=!code_show,show=code_show?"block":"none",code_blocks=document.querySelectorAll(':not(.never-hide) > .highlight');for(let a of code_blocks)a.style.display=show}code_toggle()</script>
<a class=book-btn href=javascript:code_toggle()>Toggle Code</a>
</div>
</aside>
</main>
</body>
</html>