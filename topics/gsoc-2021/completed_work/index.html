<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Summary of the work completed for the GSOC project # This page provides a brief summary of completed (or still ongoing) work for the GSOC-2021 project.
The original proposal can found here.
Refactor Sequential Monte Carlo sampler # The main goal of the GSOC proposal involved the refactoring of the Sequential Monte Carlo (SMC) kernel and sampler.
PR #4769 reintroduced SMC in the new version of PyMC3.
These planned improvements were successfully completed:"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content><meta property="og:description" content="Summary of the work completed for the GSOC project # This page provides a brief summary of completed (or still ongoing) work for the GSOC-2021 project.
The original proposal can found here.
Refactor Sequential Monte Carlo sampler # The main goal of the GSOC proposal involved the refactoring of the Sequential Monte Carlo (SMC) kernel and sampler.
PR #4769 reintroduced SMC in the new version of PyMC3.
These planned improvements were successfully completed:"><meta property="og:type" content="article"><meta property="og:url" content="https://ricardov94.github.io/topics/gsoc-2021/completed_work/"><meta property="article:section" content="topics"><title>Completed Work | As long as everything adds up to one</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.336536302c9333426b2435f844b8628561bae88f21fec7883f90118e27d33980.css integrity="sha256-M2U2MCyTM0JrJDX4RLhihWG66I8h/seIP5ARjifTOYA=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.6248f0d4778be3a7f06cb3a79412a91077b31b0fd8bc3ea06e6436002692323d.js integrity="sha256-Ykjw1HeL46fwbLOnlBKpEHezGw/YvD6gbmQ2ACaSMj0=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a href=/><span>As long as everything adds up to one</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-d0a97e81e6c04bf86dad2e667144930c class=toggle checked>
<label for=section-d0a97e81e6c04bf86dad2e667144930c class="flex justify-between"><a role=button>Gsoc 2021</a></label><ul><li><a href=https://ricardov94.github.io/topics/gsoc-2021/proposal/>Proposal</a></li><li><a href=https://ricardov94.github.io/topics/gsoc-2021/completed_work/ class=active>Completed Work</a></li></ul></li></ul><ul><li><a href=/posts/>Blog</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Completed Work</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#refactor-sequential-monte-carlo-sampler>Refactor Sequential Monte Carlo sampler</a></li><li><a href=#refactor-simulator-used-for-approximate-bayesian-computation>Refactor Simulator used for Approximate Bayesian Computation</a></li><li><a href=#unplanned-work>Unplanned work</a></li><li><a href=#ongoing-work>Ongoing work</a></li></ul></nav><script>code_show=!0;function code_toggle(){code_show=!code_show,show=code_show?"block":"none",code_blocks=document.querySelectorAll(":not(.never-hide) > .highlight");for(let e of code_blocks)e.style.display=show}code_toggle()</script><a class=book-btn href=javascript:code_toggle()>Toggle Code</a></aside></header><article class=markdown><h1 id=summary-of-the-work-completed-for-the-gsoc-project>Summary of the work completed for the GSOC project
<a class=anchor href=#summary-of-the-work-completed-for-the-gsoc-project>#</a></h1><p>This page provides a brief summary of completed (or still ongoing) work for the GSOC-2021 project.</p><p>The original proposal can found <a href=https://ricardov94.github.io/topics/gsoc-2021/proposal/>here</a>.</p><h2 id=refactor-sequential-monte-carlo-sampler>Refactor Sequential Monte Carlo sampler
<a class=anchor href=#refactor-sequential-monte-carlo-sampler>#</a></h2><p>The main goal of the GSOC proposal involved the refactoring of the Sequential Monte Carlo (SMC) kernel and sampler.</p><p><strong>PR <a href=https://github.com/pymc-devs/pymc3/pull/4769>#4769</a> reintroduced SMC in the new version of PyMC3.</strong></p><p>These planned improvements were successfully completed:</p><span class=begin-todo-list></span><ul><li><input checked disabled type=checkbox> Add progress bar across beta stages for better progress feedback in <code>pm.sample_smc</code> (<a href=https://github.com/pymc-devs/pymc3/pull/4826>#4826</a>)</li><li><input checked disabled type=checkbox> Define a consistent modular API for easy customization of SMC kernels (<a href=https://github.com/pymc-devs/pymc3/pull/4919>#4919</a>)</li><li><input checked disabled type=checkbox> Fix missing documentation for SMC related functions and classes (<a href=https://github.com/pymc-devs/pymc3/pull/4936>#4936</a>)</li><li><input checked disabled type=checkbox> Provide two standard SMC algorithms: Independent Metropolis-Hastings (already implemented in v3), and random-walk Metropolis-Hastings (<a href=https://github.com/pymc-devs/pymc3/pull/4925>#4925</a>)</li></ul><p>The following goal was also completed in the <a href=https://github.com/pymc-devs/pymc3/pull/4826>#4826</a> PR, although some potential performance issues persist as described in <a href=https://github.com/pymc-devs/pymc3/issues/4939>#4939</a>.</p><span class=begin-todo-list></span><ul><li><input checked disabled type=checkbox> Test multiprocess sampling in SMC and provide that as default</li></ul><p>The following exploration was completed:</p><span class=begin-todo-list></span><ul><li><input checked disabled type=checkbox> Test potential speedup from vectorizing logp evaluations (results are summarized in this <a href=https://gist.github.com/ricardoV94/6089a8c46a0e19665f01c79ea04e1cb2>gist</a>)</li></ul><p>Unfortunately no obvious speedup was noticed in any of the vectorized alternatives. A follow-up investigation with a larger model may still reveal speed improvements.</p><p>In addition, the ability to evaluate a model logp in a vectorized manner may prove useful in itself, for writing a pure Aesara SMC sampler that does not need to interact with other Python code.</p><h2 id=refactor-simulator-used-for-approximate-bayesian-computation>Refactor Simulator used for Approximate Bayesian Computation
<a class=anchor href=#refactor-simulator-used-for-approximate-bayesian-computation>#</a></h2><p>A second major focus of the project was related to the Simulator distribution used in Approximate Bayesian Computation (ABC). In summary a Simulator is an object that draws simulated data given some parameters of interest. When doing ABC, the Simulator distribution provides a stochastic &ldquo;Pseudo-likelihood&rdquo; defined by a distance metric between the observed data and the simulated data at each iteration.</p><p>Prior to the GSOC, the Simulator distribution had completely different internals from more conventional PyMC3 distributions, which required custom logic for nearly every functionality users expect distributions to have in the library.</p><p><strong>The refactoring work for <code>pm.Simulator</code> is included in the still open <a href=https://github.com/pymc-devs/pymc3/pull/4903>#4903</a> PR</strong>. Some final touches are still being discussed, but is otherwise complete. It solves the following goals from the original proposal:</p><span class=begin-todo-list></span><ul><li><input checked disabled type=checkbox> Wrap the <code>pm.Simulator</code> object around custom <code>RandomOp</code>s for a more consistent integration within the PyMC3 model object</li><li><input checked disabled type=checkbox> Fix broken Prior and Posterior predictive sampling when using <code>pm.Simulator</code></li><li><input checked disabled type=checkbox> Fix broken <code>graphviz</code> representation when using <code>pm.Simulator</code></li><li><input checked disabled type=checkbox> Allow for multiple Simulators within a single model</li><li><input checked disabled type=checkbox> Use of Simulator in normal NUTS sampling</li><li><input checked disabled type=checkbox> Allow the Mixing of Simulator Pseudo-likelihoods and True-likelihoods in a single <code>SMC</code> model</li></ul><p>It&rsquo;s interesting to note that fixing the first sub-goal automatically resolved the following ones, because the library could now handle Simulator variables as it handles any other variables!</p><p>The following goals were also completed:</p><span class=begin-todo-list></span><ul><li><input checked disabled type=checkbox> Fix missing documentation for <code>pm.Simulator</code></li><li><input checked disabled type=checkbox> Allow <code>pm.Simulator</code> wrapped function to take non-named inputs and provide more useful error messages for
improper initialization</li></ul><h2 id=unplanned-work>Unplanned work
<a class=anchor href=#unplanned-work>#</a></h2><p>As expected, when one dives deep in a codebase new bugs or obvious things that could be changed emerge. Here are some of these:</p><span class=begin-todo-list></span><ul><li><input checked disabled type=checkbox> Fix <code>pm.sample_smc</code> failing with models containing multiple Potentials / Likelihoods (<a href=https://github.com/pymc-devs/pymc3/pull/4843>#4843</a>)</li><li><input checked disabled type=checkbox> Fix limitations around discrete variables in <code>pm.sample_smc</code> by automatically replacing the input integer variables by rounded float variables (<a href=https://github.com/pymc-devs/pymc3/pull/4898>#4898</a>)</li><li><input checked disabled type=checkbox> Return <code>InferenceData</code> objects from <code>pm.sample_smc</code> (<a href=https://github.com/pymc-devs/pymc3/pull/4814>#4814</a>)</li></ul><h2 id=ongoing-work>Ongoing work
<a class=anchor href=#ongoing-work>#</a></h2><p>The planned in-depth examples will only be delivered after the GSOC deadline:</p><span class=begin-todo-list></span><ul><li><input disabled type=checkbox> Adapt and extend toy example from Bååth (2014), emphasizing the advantages and disadvantages of ABC sampling.</li><li><input disabled type=checkbox> Write case-study discussing the accuracy of ABC vs true-likelihood sampling in simple Cognitive research models with known Likelihood forms described in Palestro et al., (2018).</li><li><input disabled type=checkbox> Write tutorial on how to implement a custom SMC-kernel (Independent Metropolis Hastings with mixture of Gaussians) to facilitate future research and development of SMC(-ABC) in PyMC3.</li></ul><p>These small updates are still missing:</p><span class=begin-todo-list></span><ul><li><input disabled type=checkbox> Automatically select SMC-ABC when <code>pm.Simulator</code> is present in a model</li><li><input disabled type=checkbox> Add a Probability Density Approximation (PDA) method based on a Gaussian or Epanechnikov kernel as an alternative to the epsilon based distance Pseudo-likelihood (Turner & Sederberg, 2014)</li><li><input disabled type=checkbox> Reintroduce the KL-Divergence distance metric</li></ul><p>Finally, the following ideas are still being explored:</p><span class=begin-todo-list></span><ul><li><input disabled type=checkbox> Test potential speedup from fully integrated Aesara SMC sampling kernel</li><li><input disabled type=checkbox> Proof of concept SMC sampling with Hamiltonian sampling mutation kernel</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/ricardoV94/ricardoV94.github.io.website/edit/master/content/topics/gsoc-2021/completed_work.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#refactor-sequential-monte-carlo-sampler>Refactor Sequential Monte Carlo sampler</a></li><li><a href=#refactor-simulator-used-for-approximate-bayesian-computation>Refactor Simulator used for Approximate Bayesian Computation</a></li><li><a href=#unplanned-work>Unplanned work</a></li><li><a href=#ongoing-work>Ongoing work</a></li></ul></nav><script>code_show=!0;function code_toggle(){code_show=!code_show,show=code_show?"block":"none",code_blocks=document.querySelectorAll(":not(.never-hide) > .highlight");for(let e of code_blocks)e.style.display=show}code_toggle()</script><a class=book-btn href=javascript:code_toggle()>Toggle Code</a></div></aside></main></body></html>